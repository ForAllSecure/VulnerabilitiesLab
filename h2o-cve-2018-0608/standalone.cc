#ifdef STANDALONE

#include <stdint.h>
#include <sys/types.h>

#include <iostream>
#include <fstream>

extern "C" int LLVMFuzzerTestOneInput(const uint8_t *Data, size_t Size);

int main(int argc, char **argv) {
    uint8_t *data;
    size_t size;

    if (argc != 2) return 1;

    std::ifstream file (argv[1], std::ios::in | std::ios::binary | std::ios::ate);
    if (!file.is_open()) return 1;

    size = file.tellg();
    data = new uint8_t[size];
    file.seekg(0, std::ios::beg);
    file.read((char *)data, size);
    file.close();

    LLVMFuzzerTestOneInput(data, size);

    return 0;
}

#endif
