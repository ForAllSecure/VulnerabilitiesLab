# h2o memory corruption CVE example

This repo replicates finding [CVE-2018-0608](https://nvd.nist.gov/vuln/detail/CVE-2018-0608), a memory corruption bug that may allow a remote attacker to run arbitrary code ([CVSS Score](https://nvd.nist.gov/vuln-metrics/cvss): 9.8).

We reported this bug responsibly to the maintainers, with the follow-on issue tracking [here](https://github.com/h2o/h2o/issues/1775).

> Note: since this finds the bug in an unmodified h2o binary
> (a *network target*), it can only be found by fuzzers that support network
> fuzzing (such as Mayhem).

## To build

Assuming you just want to build the docker image, run from the project
directory (`h2o-cve-2018-0608`):

```bash
docker build -t forallsecure/h2o-cve-2018-0608 .
```

## Get from Dockerhub

If you don't want to build locally, you can pull a pre-built image
directly from dockerhub:

```bash
docker pull forallsecure/h2o-cve-2018-0608
```


## Run under Mayhem

From the project directory (`h2o-cve-2018-0608`) run:

```bash
mayhem run mayhem/h2o
```

## POC

We have included a proof of concept output under the `poc`
directory.

> Note: Fuzzing has some degree of non-determinism, so when you run
yourself you may not get exactly this file.  This is expected; your
output should still trigger the memory corruption bug.

This bug was originally found and [responsibly disclosed](https://github.com/h2o/h2o/issues/1775) by ForAllSecure employee [Marlies Ruck](https://blog.forallsecure.com/author/marlies-ruck). As such, this bug has since been [fixed](https://github.com/h2o/h2o/commit/69506c9e2defa4922f62f389c76d89e9274b3cc1) by project maintainers.
