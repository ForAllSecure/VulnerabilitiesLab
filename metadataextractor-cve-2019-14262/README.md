# Metadata Extractor CVE-2019-14262 Example

This target replicates finding [CVE-2019-14262](https://nvd.nist.gov/vuln/detail/CVE-2019-14262), a stack exhaustion bug caused by uncontrolled recursion in version 2.1.0 of the metadata-extractor library ([CVSS Score](https://nvd.nist.gov/vuln-metrics/cvss): 7.5).

This vulnerability was reported to the maintainers and resolved [here](https://github.com/drewnoakes/metadata-extractor/issues/419).

Note that the CVE is for the C# version of the same code, where one cannot typically recover from a stack overflow.
This example reproduces the vulnerability in the Java version to demonstrate the Java fuzzing capabilities of Mayhem.

## To build

Assuming you just want to build the docker image, run:

```bash
docker build -t forallsecure/metadataextractor-cve-2019-14262 .
```

## Get from Dockerhub

If you don't want to build locally, you can pull a pre-built image directly from Dockerhub:

```bash
docker pull forallsecure/metadataextractor-cve-2019-14262
```

## Run under Mayhem

Change to the `metadataextractor-cve-2019-14262` folder and run:

```bash
mayhem run mayhem/metadataextractor
```

and watch Mayhem replicate the bug!
This bug should be found within a minute of starting the run.

## Run locally

Change to the `metadataextractor-cve-2019-14262` folder and run:

```bash
docker run --rm -v `pwd`:/in forallsecure/metadataextractor-cve-2019-14262 /in/mayhem/metadataextractor/poc/crashing-input
```

## POC

We have included a proof of concept output under the `poc` directory.

> Note: Fuzzing has some degree of non-determinism, so when you run yourself you may not get exactly this file.
> This is expected; your output should still trigger the bug.

This bug was originally found by ForAllSecure employee [Alex Rebert](https://forallsecure.com/about-us).
This bug has since been [fixed](https://github.com/drewnoakes/metadata-extractor/issues/419) by project maintainers.
