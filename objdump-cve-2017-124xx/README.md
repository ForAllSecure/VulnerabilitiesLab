# objdump CVE 2017-124xx example

This repo replicates many of the CVE's found in the objdump binary and libbfd.
Bugs found include heap use after free, heap out of bounds read/write,
arbitrary read, and null pointer dereference. These bugs were especially
exciting to find because many bugs had been found by fuzzers in libbfd in
the months prior before tapering off. Mayhem was able to find new bugs that
other fuzzers were not.

We reported these bugs responsibly to the maintainers and the bugs have been
fixed.

> Note: since this finds the bug in an unmodified objdump binary, it can only
> be found by fuzzers that support black box binary *guided* fuzzing (such as
> [Mayhem](https://www.forallsecure.com/solutions/devsecops/)).

## List of CVE's
- CVE-2017-12448(https://nvd.nist.gov/vuln/detail/CVE-2017-12448)
- CVE-2017-12450(https://nvd.nist.gov/vuln/detail/CVE-2017-12450)
- CVE-2017-12459(https://nvd.nist.gov/vuln/detail/CVE-2017-12459)
- CVE-2017-12454(https://nvd.nist.gov/vuln/detail/CVE-2017-12454)
- CVE-2017-12452(https://nvd.nist.gov/vuln/detail/CVE-2017-12452)
- CVE-2017-12456(https://nvd.nist.gov/vuln/detail/CVE-2017-12456)
- CVE-2017-12453(https://nvd.nist.gov/vuln/detail/CVE-2017-12453)
- CVE-2017-12449(https://nvd.nist.gov/vuln/detail/CVE-2017-12449)
- CVE-2017-12455(https://nvd.nist.gov/vuln/detail/CVE-2017-12455)
- CVE-2017-12458(https://nvd.nist.gov/vuln/detail/CVE-2017-12458)
- CVE-2017-12451(https://nvd.nist.gov/vuln/detail/CVE-2017-12451)
- CVE-2017-12457(https://nvd.nist.gov/vuln/detail/CVE-2017-12457)

## To build

Assuming you just want to build the docker image, run:

```bash
docker build -t forallsecure/objdump-cve-2017-124xx .
```

## Get from Dockerhub

If you don't want to build locally, you can pull a pre-built image
directly from dockerhub:

```bash
docker pull forallsecure/objdump-cve-2017-124xx
```


## Run under Mayhem

Change to the `objdump-cve-2017-124xx` folder and run:

```bash
mayhem run mayhem/objdump
```

and watch Mayhem replicate the bugs! These bugs take very little time (~5 minutes)
to find (more will come in after the 5 minute mark)!

## Run locally

Since this is a uninstrumented binary, it can be fuzzed by fuzzers such as
afl-qemu. However, using [Mayhem] (https://www.forallsecure.com/solutions/devsecops/)
will provide better coverage through the addition of symbolic execution!

## POC

We have included a proof of concept output under the `poc`
directory.

> Note: Fuzzing has some degree of non-determinism, so when you run
yourself you may not get exactly this file.  This is expected; your
output should still trigger the sthttpd bug.

These bugs were originally found and responsibly disclosed
by ForAllSecure employee [Ned Williamson](https://twitter.com/nedwilliamson).
As such, these bugs have since been fixed by project maintainers.
