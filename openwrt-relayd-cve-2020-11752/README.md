# OpenWRT mdns CVE-2020-11752

Three out-of-bounds access issues were found in OpenWRT's relayd. They were reported to the OpenWRT security address on April 9 2020, and a fix ([1](https://git.openwrt.org/?p=project/relayd.git;a=commit;h=796da66abd074037f3b48475772d65874cc6de54), [2](https://git.openwrt.org/?p=project/relayd.git;a=commit;h=f4d759be54ceb37714e9a6ca320d5b50c95e9ce9)) was released soon after.

The code included in this project is an edited version of the original OpenWRT relayd code.

## To build

Assuming you just want to build the docker image, run:

```bash
docker build -t forallsecure/openwrt-relayd-cve-2020-11752 .
```

## Get from Dockerhub

If you don't want to build locally, you can pull a pre-built image
directly from dockerhub:

```bash
docker pull forallsecure/openwrt-relayd-cve-2020-11752
```


## Run under Mayhem

Change to the `openwrt-relayd-cve-2020-11752` folder and run:

```bash
mayhem run mayhem/relayd
```

and watch Mayhem replicate the bugs! These bugs take seconds!

## Run locally

You can run this locally by running the libfuzzer harness or standalone harness
with qemu-afl inside the docker container.

## POC

We have included a proof of concept output under the `poc`
directory.

> Note: Fuzzing has some degree of non-determinism, so when you run
yourself you may not get exactly this file.  This is expected; your
output should still trigger the Oniguruma regex bug.
