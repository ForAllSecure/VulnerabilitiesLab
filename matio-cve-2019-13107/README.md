# MATIO CVE 2019-13107

 This repo replicates findings in the MATLAB file I/O library MATIO where crafted inputs could result in multiple integer overflows. You can find the CVE report [here](https://nvd.nist.gov/vuln/detail/CVE-2019-13107) ([CVSS Score](https://nvd.nist.gov/vuln-metrics/cvss): 9.8).

 We reported this bug responsibly to the maintainers, fixed [here](https://github.com/tbeu/matio/pull/118).

 You can read more about these bugs and how we found them at the [ForAllSecure Blog](https://blog.forallsecure.com/analyzing-matio-and-stb_vorbis-libraries-with-mayhem).

 ## To build

 Assuming you just want to build the docker image, run:

 ```bash
 docker build -t forallsecure/matio-cve-2019-13107 .
 ```

 ## Get from Dockerhub

 If you don't want to build locally, you can pull a pre-built image
 directly from dockerhub:

 ```bash
 docker pull forallsecure/matio-cve-2019-13107
 ```


 ## Run under Mayhem

 Change to the `matio-cve-2019-13107` folder and run:

 ```bash
 mayhem run mayhem/matio
 ```

 and watch Mayhem replicate the bugs! These bugs take seconds!

 ## Run locally

 You can run this locally by running the libfuzzer harness or standalone harness
 with qemu-afl inside the docker container.

 ## POC

 We have included a proof of concept output under the `poc`
 directory.

 > Note: Fuzzing has some degree of non-determinism, so when you run
 yourself you may not get exactly this file.  This is expected; your
 output should still trigger the Oniguruma regex bug.

 These bugs were originally found by ForAllSecure employee [Maxwell Koo](https://blog.forallsecure.com/author/maxwell-koo).
 These bug have since been fixed [here](https://github.com/tbeu/matio/pull/118) by Max and project maintainers.
